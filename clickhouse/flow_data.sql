-- Generated Schema from flow-20250821.tsv
-- Target Database: datastoreEval
-- Target Table: stardust_flow

CREATE TABLE IF NOT EXISTS `datastoreEval`.`stardust_flow` (
    `@timestamp` DateTime64(3, 'UTC'),
    `end` Nullable(String),
    `start` Nullable(String),
    `stitched_flows` Nullable(String),
    `ts_id` Nullable(String),
    `type` Nullable(String),
    `meta.app_name` Nullable(String),
    `meta.app_name_detail` Nullable(String),
    `meta.app_port` Nullable(String),
    `meta.as_names` Nullable(String),
    `meta.as_names_str` Nullable(String),
    `meta.bgp.as_hop0` Nullable(String),
    `meta.bgp.as_hop0_name` Nullable(String),
    `meta.bgp.as_hop0_padding` Nullable(String),
    `meta.bgp.as_hop1` Nullable(String),
    `meta.bgp.as_hop1_name` Nullable(String),
    `meta.bgp.as_hop1_padding` Nullable(String),
    `meta.bgp.as_hop2` Nullable(String),
    `meta.bgp.as_hop2_name` Nullable(String),
    `meta.bgp.as_hop2_padding` Nullable(String),
    `meta.bgp.as_hop3` Nullable(String),
    `meta.bgp.as_hop3_name` Nullable(String),
    `meta.bgp.as_hop3_padding` Nullable(String),
    `meta.bgp.as_hop4` Nullable(String),
    `meta.bgp.as_hop4_name` Nullable(String),
    `meta.bgp.as_hop4_padding` Nullable(String),
    `meta.bgp.as_hop5` Nullable(String),
    `meta.bgp.as_hop5_name` Nullable(String),
    `meta.bgp.as_hop5_padding` Nullable(String),
    `meta.bgp.as_hop6` Nullable(String),
    `meta.bgp.as_hop6_name` Nullable(String),
    `meta.bgp.as_hop6_padding` Nullable(String),
    `meta.bgp.as_hop7` Nullable(String),
    `meta.bgp.as_hop7_name` Nullable(String),
    `meta.bgp.as_hop7_padding` Nullable(String),
    `meta.bgp.as_path` Nullable(String),
    `meta.bgp.as_path_len` Nullable(String),
    `meta.bgp.as_path_name` Nullable(String),
    `meta.bgp.as_path_name_str` Nullable(String),
    `meta.bgp.as_path_org` Nullable(String),
    `meta.bgp.as_path_padded_len` Nullable(String),
    `meta.bgp.as_path_str` Nullable(String),
    `meta.bgp.comms` Nullable(String),
    `meta.bgp.comms_str` Nullable(String),
    `meta.bgp.ecomms` Nullable(String),
    `meta.bgp.ecomms_str` Nullable(String),
    `meta.bgp.lcomms_str` Nullable(String),
    `meta.bgp.local_pref` Nullable(String),
    `meta.bgp.med` Nullable(String),
    `meta.bgp.next_hop` Nullable(String),
    `meta.bgp.peer_as_dst` Nullable(String),
    `meta.bgp.peer_as_dst_name` Nullable(String),
    `meta.bgp.peer_as_dst_org` Nullable(String),
    `meta.country_names` Nullable(String),
    `meta.country_names_str` Nullable(String),
    `meta.country_scope` Nullable(String),
    `meta.cric.dst` Nullable(String),
    `meta.cric.src` Nullable(String),
    `meta.device_info.loc_name` Nullable(String),
    `meta.device_info.loc_type` Nullable(String),
    `meta.device_info.location.lat` Nullable(String),
    `meta.device_info.location.lon` Nullable(String),
    `meta.device_info.manufacturer` Nullable(String),
    `meta.device_info.model` Nullable(String),
    `meta.device_info.network` Nullable(String),
    `meta.device_info.os` Nullable(String),
    `meta.device_info.role` Nullable(String),
    `meta.device_info.state` Nullable(String),
    `meta.dscp` Nullable(String),
    `meta.dst_as_name` Nullable(String),
    `meta.dst_asn` Nullable(String),
    `meta.dst_continent` Nullable(String),
    `meta.dst_country_name` Nullable(String),
    `meta.dst_ip` Nullable(String),
    `meta.dst_location.lat` Nullable(String),
    `meta.dst_location.lon` Nullable(String),
    `meta.dst_organization` Nullable(String),
    `meta.dst_port` Nullable(String),
    `meta.dst_preferred_location.lat` Nullable(String),
    `meta.dst_preferred_location.lon` Nullable(String),
    `meta.dst_preferred_org` Nullable(String),
    `meta.dst_pub_asn` Nullable(String),
    `meta.dst_region_iso_code` Nullable(String),
    `meta.dst_region_name` Nullable(String),
    `meta.esdb.dst.org.full_name` Nullable(String),
    `meta.esdb.dst.org.funding_agency` Nullable(String),
    `meta.esdb.dst.org.hide` Nullable(String),
    `meta.esdb.dst.org.short_name` Nullable(String),
    `meta.esdb.dst.org.types` Nullable(String),
    `meta.esdb.dst.service.label` Nullable(String),
    `meta.esdb.dst.service.prefix_group_name` Nullable(String),
    `meta.esdb.dst.service.type` Nullable(String),
    `meta.esdb.sites` Nullable(String),
    `meta.esdb.sites_str` Nullable(String),
    `meta.esdb.src.org.full_name` Nullable(String),
    `meta.esdb.src.org.funding_agency` Nullable(String),
    `meta.esdb.src.org.hide` Nullable(String),
    `meta.esdb.src.org.short_name` Nullable(String),
    `meta.esdb.src.org.types` Nullable(String),
    `meta.esdb.src.service.label` Nullable(String),
    `meta.esdb.src.service.prefix_group_name` Nullable(String),
    `meta.esdb.src.service.type` Nullable(String),
    `meta.five_tuple_id` Nullable(String),
    `meta.flow_type` Nullable(String),
    `meta.id` Nullable(String),
    `meta.iface_in.description` Nullable(String),
    `meta.iface_in.device` String,
    `meta.iface_in.id` Nullable(String),
    `meta.iface_in.ifindex` Nullable(String),
    `meta.iface_in.intercloud` Nullable(String),
    `meta.iface_in.ipv4` Nullable(String),
    `meta.iface_in.ipv6` Nullable(String),
    `meta.iface_in.lhcone` Nullable(String),
    `meta.iface_in.name` String,
    `meta.iface_in.netflow_index` Nullable(String),
    `meta.iface_in.peer.as_name` Nullable(String),
    `meta.iface_in.peer.asn` Nullable(String),
    `meta.iface_in.peer.ip` Nullable(String),
    `meta.iface_in.port_name` Nullable(String),
    `meta.iface_in.remote.device` Nullable(String),
    `meta.iface_in.remote.full_name` Nullable(String),
    `meta.iface_in.remote.id` Nullable(String),
    `meta.iface_in.remote.lldp_device` Nullable(String),
    `meta.iface_in.remote.lldp_port` Nullable(String),
    `meta.iface_in.remote.loc_name` Nullable(String),
    `meta.iface_in.remote.loc_type` Nullable(String),
    `meta.iface_in.remote.location.lat` Nullable(String),
    `meta.iface_in.remote.location.lon` Nullable(String),
    `meta.iface_in.remote.manufacturer` Nullable(String),
    `meta.iface_in.remote.model` Nullable(String),
    `meta.iface_in.remote.network` Nullable(String),
    `meta.iface_in.remote.os` Nullable(String),
    `meta.iface_in.remote.port` Nullable(String),
    `meta.iface_in.remote.role` Nullable(String),
    `meta.iface_in.remote.short_name` Nullable(String),
    `meta.iface_in.remote.state` Nullable(String),
    `meta.iface_in.site` Nullable(String),
    `meta.iface_in.speed` Nullable(String),
    `meta.iface_in.visibility` Nullable(String),
    `meta.iface_in.vrtrifglobalindex` Nullable(String),
    `meta.iface_in.vrtrifindex` Nullable(String),
    `meta.iface_in.vrtrname` Nullable(String),
    `meta.iface_out.description` Nullable(String),
    `meta.iface_out.device` Nullable(String),
    `meta.iface_out.id` Nullable(String),
    `meta.iface_out.ifindex` Nullable(String),
    `meta.iface_out.intercloud` Nullable(String),
    `meta.iface_out.ipv4` Nullable(String),
    `meta.iface_out.ipv6` Nullable(String),
    `meta.iface_out.lhcone` Nullable(String),
    `meta.iface_out.name` Nullable(String),
    `meta.iface_out.netflow_index` Nullable(String),
    `meta.iface_out.peer.asn` Nullable(String),
    `meta.iface_out.peer.ipv4` Nullable(String),
    `meta.iface_out.peer.ipv6` Nullable(String),
    `meta.iface_out.port_name` Nullable(String),
    `meta.iface_out.remote.device` Nullable(String),
    `meta.iface_out.remote.full_name` Nullable(String),
    `meta.iface_out.remote.id` Nullable(String),
    `meta.iface_out.remote.lldp_device` Nullable(String),
    `meta.iface_out.remote.lldp_port` Nullable(String),
    `meta.iface_out.remote.loc_name` Nullable(String),
    `meta.iface_out.remote.loc_type` Nullable(String),
    `meta.iface_out.remote.location.lat` Nullable(String),
    `meta.iface_out.remote.location.lon` Nullable(String),
    `meta.iface_out.remote.manufacturer` Nullable(String),
    `meta.iface_out.remote.model` Nullable(String),
    `meta.iface_out.remote.network` Nullable(String),
    `meta.iface_out.remote.os` Nullable(String),
    `meta.iface_out.remote.port` Nullable(String),
    `meta.iface_out.remote.role` Nullable(String),
    `meta.iface_out.remote.short_name` Nullable(String),
    `meta.iface_out.remote.state` Nullable(String),
    `meta.iface_out.site` Nullable(String),
    `meta.iface_out.speed` Nullable(String),
    `meta.iface_out.visibility` Nullable(String),
    `meta.iface_out.vrtrifglobalindex` Nullable(String),
    `meta.iface_out.vrtrifindex` Nullable(String),
    `meta.iface_out.vrtrname` Nullable(String),
    `meta.ip_tos` Nullable(String),
    `meta.ip_version` Nullable(String),
    `meta.ipv6.flow_label` Nullable(String),
    `meta.is_l2` Nullable(String),
    `meta.is_network_testing` Nullable(String),
    `meta.mpls.bottom_label` Nullable(String),
    `meta.mpls.exp1` Nullable(String),
    `meta.mpls.exp10` Nullable(String),
    `meta.mpls.exp2` Nullable(String),
    `meta.mpls.exp3` Nullable(String),
    `meta.mpls.exp4` Nullable(String),
    `meta.mpls.exp5` Nullable(String),
    `meta.mpls.exp6` Nullable(String),
    `meta.mpls.exp7` Nullable(String),
    `meta.mpls.exp8` Nullable(String),
    `meta.mpls.exp9` Nullable(String),
    `meta.mpls.label1` Nullable(String),
    `meta.mpls.label10` Nullable(String),
    `meta.mpls.label2` Nullable(String),
    `meta.mpls.label3` Nullable(String),
    `meta.mpls.label4` Nullable(String),
    `meta.mpls.label5` Nullable(String),
    `meta.mpls.label6` Nullable(String),
    `meta.mpls.label7` Nullable(String),
    `meta.mpls.label8` Nullable(String),
    `meta.mpls.label9` Nullable(String),
    `meta.mpls.labels` Nullable(String),
    `meta.mpls.pw_id` Nullable(String),
    `meta.mpls.stack_depth` Nullable(String),
    `meta.mpls.top_label` Nullable(String),
    `meta.mpls.top_label_ip` Nullable(String),
    `meta.mpls.top_label_type` Nullable(String),
    `meta.mpls.vpn_rd` Nullable(String),
    `meta.protocol` Nullable(String),
    `meta.region_iso_codes` Nullable(String),
    `meta.region_iso_codes_str` Nullable(String),
    `meta.region_names` Nullable(String),
    `meta.region_names_str` Nullable(String),
    `meta.router.ip` Nullable(String),
    `meta.router.name` Nullable(String),
    `meta.scireg.dst.discipline` Nullable(String),
    `meta.scireg.dst.latitude` Nullable(String),
    `meta.scireg.dst.longitude` Nullable(String),
    `meta.scireg.dst.org_abbr` Nullable(String),
    `meta.scireg.dst.org_name` Nullable(String),
    `meta.scireg.dst.project_names` Nullable(String),
    `meta.scireg.dst.project_names_str` Nullable(String),
    `meta.scireg.dst.resource` Nullable(String),
    `meta.scireg.dst.resource_abbr` Nullable(String),
    `meta.scireg.dst.role` Nullable(String),
    `meta.scireg.project_names` Nullable(String),
    `meta.scireg.project_names_str` Nullable(String),
    `meta.scireg.src.discipline` Nullable(String),
    `meta.scireg.src.latitude` Nullable(String),
    `meta.scireg.src.longitude` Nullable(String),
    `meta.scireg.src.org_abbr` Nullable(String),
    `meta.scireg.src.org_name` Nullable(String),
    `meta.scireg.src.project_names` Nullable(String),
    `meta.scireg.src.project_names_str` Nullable(String),
    `meta.scireg.src.resource` Nullable(String),
    `meta.scireg.src.resource_abbr` Nullable(String),
    `meta.scireg.src.role` Nullable(String),
    `meta.sensor_id` Nullable(String),
    `meta.src_as_name` Nullable(String),
    `meta.src_asn` Nullable(String),
    `meta.src_continent` Nullable(String),
    `meta.src_country_name` Nullable(String),
    `meta.src_ip` Nullable(String),
    `meta.src_location.lat` Nullable(String),
    `meta.src_location.lon` Nullable(String),
    `meta.src_organization` Nullable(String),
    `meta.src_port` Nullable(String),
    `meta.src_preferred_location.lat` Nullable(String),
    `meta.src_preferred_location.lon` Nullable(String),
    `meta.src_preferred_org` Nullable(String),
    `meta.src_pub_asn` Nullable(String),
    `meta.src_region_iso_code` Nullable(String),
    `meta.src_region_name` Nullable(String),
    `meta.traffic_class` Nullable(String),
    `meta.vrf.egress_id` Nullable(String),
    `meta.vrf.ingress_id` Nullable(String),
    `values.bits_per_second` Nullable(Float64),
    `values.duration` Nullable(Float64),
    `values.max_packet_len` Nullable(Float64),
    `values.max_ttl` Nullable(Float64),
    `values.min_packet_len` Nullable(Float64),
    `values.min_ttl` Nullable(Float64),
    `values.num_bits` Nullable(Float64),
    `values.num_packets` Nullable(Float64),
    `values.packets_per_second` Nullable(Float64)
)
ENGINE = MergeTree()
PARTITION BY toYYYYMM(`@timestamp`)
ORDER BY (`meta.iface_in.name`, `@timestamp`, `meta.iface_in.device`);
